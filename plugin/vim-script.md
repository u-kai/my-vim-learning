# Vim script の基本

## Vim script の実行

-   Vim script は Ex コマンド(:から始まるコマンド)の集まり
-   Ex コマンド群をファイルに記述して:source {file}で読み込んで実行することができる
-   ファイルの拡張子は.vim でやることが一般的
-   シングルクォーとはそのままの文字列を評価するので，特殊文字を利用したいときは""
-   文字列の結合は.

    -   "Hello "."World"

-   変数の宣言と代入は let
    ```vim
    let name = "Hello"
    echo name
    ```

## スコープ

-   変数や関数にはスコープがあり，接頭辞によってスコープが変わる
-   主なスコープは次になる
-   g:
    -   グローバルでどこからも利用可能
-   s:

    -   スクリプトファイル内のみ使用可能

-   l:

    -   関数ローカルスコープで関数ないのみ使用可能
    -   省略すると暗黙的にこのスコープになる

-   a:

-   v:
    -   Vim があらかじめ定義している変数
    -   関数の引数

## 関数

-   Vim script では関数を使用して処理をまとめることができる
-   関数の定義は次のようになる

```
function! Echo(msg) abort
    echo a:msg
endfunction
```

-   function と endfunction で囲む
-   !は同名の関数がある場合は上書きする
-   abort は関数ないでエラーが発生した場合はそこで処理を終了する
-   Vim script はデフォルトでエラーがあっても処理が継続されるため基本的に abort をつけると良い

-   引数を使用するときは a:スコープをつける必要がある

## 外部コマンド実行

-   system({expr},{input})で外部コマンドを実行できる
-   {expr}は実行したいコマンドの文字列
-   {input}は省略可能で指定した場合は文字列をそのままコマンドの標準入力として扱う
